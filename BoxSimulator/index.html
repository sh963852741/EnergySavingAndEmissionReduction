<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>化妆品回收箱模拟器</title>
    <script src="js/jQuery.js"></script>
    <script src="js/signalr.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/signalr.js/2.4.1/jquery.signalR.js"></script>
    <link rel="stylesheet" type="text/css" href="css/box.css">
</head>

<body>
    <div>
        <div class="box">
            <div class="state" id="state-text">箱子打开</div>
        </div>
    </div>
    <div style="display: flex; justify-content: space-around; margin-top: 24px;">
        <button id="open-box-button">打开箱子</button>
        <button id="close-box-button">关闭箱子</button>
    </div>
    <script type="text/javascript">
        $(function () {
            $("#open-box-button").click(function () {
                $("#state-text").text("箱子打开");
            })
            $("#close-box-button").click(function () {
                $("#state-text").text("箱子关闭");
            })
        })

        let connection = new signalR.HubConnectionBuilder().withUrl("/hub").build();

        connection.on("Open", function () {
            alert("收到消息了！");
        });

        connection.start().then(function () {
            alert("成功连接了");
        }).catch(function (err) {
            return console.error(err.toString());
        });

        connection.invoke("OpenBox", user, message).catch(function (err) {
            return console.error(err.toString());
        });
    </script>
</body>

</html>